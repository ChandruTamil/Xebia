angular.module("todomvc").controller("TodoCtrl",function(e,t,o,n){"use strict";var i=e.todos=n.todos;e.newTodo="",e.editedTodo=null,e.$watch("todos",function(){e.remainingCount=o("filter")(i,{completed:!1}).length,e.completedCount=i.length-e.remainingCount,e.allChecked=!e.remainingCount},!0),e.$on("$routeChangeSuccess",function(){var o=e.status=t.status||"";e.statusFilter="active"===o?{completed:!1}:"completed"===o?{completed:!0}:{}}),e.addTodo=function(){var t={title:e.newTodo.trim(),completed:!1};t.title&&(e.saving=!0,n.insert(t).then(function(){e.newTodo=""}).finally(function(){e.saving=!1}))},e.editTodo=function(t){e.editedTodo=t,e.originalTodo=angular.extend({},t)},e.saveEdits=function(t,o){"blur"!==o||"submit"!==e.saveEvent?(e.saveEvent=o,e.reverted?e.reverted=null:(t.title=t.title.trim(),t.title!==e.originalTodo.title?n[t.title?"put":"delete"](t).then(function(){},function(){t.title=e.originalTodo.title}).finally(function(){e.editedTodo=null}):e.editedTodo=null)):e.saveEvent=null},e.revertEdits=function(t){i[i.indexOf(t)]=e.originalTodo,e.editedTodo=null,e.originalTodo=null,e.reverted=!0},e.removeTodo=function(e){n.delete(e)},e.saveTodo=function(e){n.put(e)},e.toggleCompleted=function(e,t){angular.isDefined(t)&&(e.completed=t),n.put(e,i.indexOf(e)).then(function(){},function(){e.completed=!e.completed})},e.clearCompletedTodos=function(){n.clearCompleted()},e.markAll=function(t){i.forEach(function(o){o.completed!==t&&e.toggleCompleted(o,t)})}});